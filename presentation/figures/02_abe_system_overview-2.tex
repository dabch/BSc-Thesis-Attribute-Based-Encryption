\begin{figure}
    \centering
    \begin{subfigure}[t]{0.55\textwidth}
        \centering
        \addtocounter{subfigure}{2}
        \begin{tikzpicture}[actor/.style={draw, minimum width=1.5cm}]
            \node[actor] (a) at (-2,0) {Alice};
            \node[actor] (b) at (2,0) {Bob};
            \node[actor] (kgc) at (0,1.5) {KGC};
        
            \node[above, align=center] at (kgc.north) {$\{PK, MK\}$};

            \node[below, align=center] at (a.south) {{\{$PK$, $\textcolor{olive}{k_A}$\}}\\$\{m, \omega\}$\\$\textcolor{red}{c}:=\text{Encrypt}(PK, m, \omega)$};
            \node[below, align=center] at (b.south) {\{$PK$, $\textcolor{blue}{k_B}$\}\\$m:=\text{Decrypt}(\textcolor{red}{c},\textcolor{blue}{k_B})$};
            % \node[below, align=center] at (a.south) {$\{PK, k_{A}\}$\\$\{m, \omega\}$};;
            % \node[below, align=center] at (b.south) {$\{PK, k_{B}\}$\\$m:=\text{Decrypt}(c,k_B)$};

            \draw[->] (a) edge node (c) [above] {$\textcolor{red}{c}$} (b);

            % \draw[->] (c.north) -- ++(0,.2) node [anchor=south] {\small $\omega$};
        \end{tikzpicture}
        \caption{Alice and Bob exchange encrypted messages without involvement of the KGC.}
    \end{subfigure}
    % \begin{subfigure}[b]{0.4\textwidth}
    %     \centering
    %     \begin{tikzpicture}[matrixstyle/.style={
    %         matrix of nodes,
    %         nodes in empty cells,
    %         column sep      = 0mm,
    %         row sep         = 2mm,
    %         draw,
    %         nodes={
    %             inner sep=1mm,outer sep=1mm,
    %             minimum size=5mm,
    %             anchor=center,
    %             text centered,
    %             text width=1cm,
    %             execute at begin node={\small\setlength{\baselineskip}{1em}} % WTF.. see https://tex.stackexchange.com/questions/223065/how-to-increase-line-spacing-in-tikz-node
    %         }
    %     }]
    %         \matrix (m) [matrixstyle] at (0,0) {
    %             $PK$ & \node[align=left, text width=3.5cm] {Public Key (same\\for all participants)};\\
    %             $MK$ & \node[align=left, text width=3.5cm] {Master Secret (known\\only to the KGC)};\\
    %             $k_A, k_B$ & \node[align=left, text width=3.5cm] {Private\\Decryption Keys};\\
    %             $S_A, S_B$ & \node[align=left, text width=3.5cm] {Access Structures};\\
    %             $m$ & \node[align=left, text width=3.5cm] {Plaintext message};\\
    %             $\omega$ & \node[align=left, text width=3.5cm] {Set of attributes};\\
    %         };
    %     \end{tikzpicture}
    % \end{subfigure}
    % \caption[Interaction of Alice, Bob and KGC in an \acrshort{abes}]{
    %     Alice wants to send an \acrshort{kp-abe} encrypted message $m$ to Bob. She wants to encrypt the message under a set of attributes $\omega$.
    %     Both Alice and Bob create a desired \gls{access-policy}, $\textcolor{olive}{S_A}$ and $\textcolor{blue}{S_B}$, respectively.
    %     Note that the \acrshort{kgc} will only issue a corresponding key if it deems that they should be allowed to obtain a key under the given access policy.

    %     % \begin{itemize}
    %     %     \item test
    %     % %     \item $PK$: Public Key (system parameters, equal for all participants)
    %     % %     \item $S_A, S_B$: Alice's and Bob's Access policies
    %     % %     \item $k_A, k_B$: Alice's and Bob's private keys (corresponding to $S_A$ and $S_B$)
    %     % %     \item $m$: Plaintext message
    %     % %     \item $\omega$: Set of attributes
    %     % \end{itemize}
    % }
    % \label{fig:abe-system}
\end{figure}